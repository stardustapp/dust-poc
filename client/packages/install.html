<template name="PackageInstall">
  <div class="install-package">
    {{#if eq stage 'select'}}
      <h3>Available packages</h3>
      <ul>
        {{#each availableList}}
          <li>
            <a href="#select">{{packageId}}</a>
            - Updated {{updatedAt}}
          </li>
        {{/each}}
      </ul>
    {{/if}}

    {{#if eq stage 'precheck'}}
      <h3>Package Precheck</h3>

      {{#with meta}}
        <p>Type: {{type}}</p>
        <p>Name: {{name}}</p>
        <p>License: {{license}}</p>
        <p>Dependencies: {{libraries}}</p>
        <p>Icon: <img src={{iconUrl}}></p>
      {{/with}}

      {{#with existingPkg}}
        <h3>A version of this package is already installed!</h3>
        <p>
          Installing will replace the existing installation
          and any changes that have been made.
          Any existing data will remain.
        </p>
        <p>
          Proceed with caution
        </p>
      {{else}}
        <p>All good! This package can be installed cleanly</p>
      {{/with}}

      <button id="install" type="button">Install package</button>
      <a href="#list">Back</a>
    {{/if}}

    {{#if eq stage 'installing'}}
      <h3>Installing package...</h3>
      <p>Please wait, this shouldn't take long.</p>
    {{/if}}

    {{#if eq stage 'installed'}}
      {{#with existingPkg}}
        <h3>{{name}} has been successfully installed!</h3>
        <p>
          <a href="/~~/packages/view/{{_id}}">
            Jump to package
          </a>
          {{! TODO: launch button }}
        </p>

      {{else}}
        <h3>Huh? The package was installed but I can't see it.</h3>
      {{/with}}
    {{/if}}

    <a href="/~~/packages">
      Cancel
    </a>
  </div>
</template>
